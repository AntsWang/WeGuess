!function(e,t){"function"==typeof t&&(e.Api=t(e))}(window,function(e){var t={v:e.Vue,options:{baseUrl:"http://115.29.110.41:8001/api/",RankUrl:"http://tymf.s1.natapp.cc/TestApi/Api/WeChat/WinRateRank",token:""},Balance:-1,Request:function(e,n,o,a,r,i){i=parseInt(i);var s=0==n.indexOf("http://")?n:t.options.baseUrl+n;if(isNaN(i)&&(i=null),"get"==e){var u=[];for(var c in o)o.hasOwnProperty(c)&&u.push(c+"="+o[c]);var h=u.join("&");t.v.http.get(s+"?"+h,{headers:{Authorization:t.options.token||"",QIC:"QIC"},timeout:i||2e4}).then(function(e){e&&e.hasOwnProperty("body")&&"function"==typeof a&&a(e.body)},function(e){try{"500"==e.status&&window.vbus.$emit("ShowToast","500错误 Token验证失败")}catch(e){}"function"==typeof r&&r(e)})}else"post"==e&&t.v.http.post(s,o,{headers:{Authorization:t.options.token||"",QIC:"QIC"},timeout:i||2e4}).then(function(e){e&&e.hasOwnProperty("body")&&"function"==typeof a&&e.body&&a(e.body)},function(e){"function"==typeof r&&r(e)})},APIRequest:function(e,n,o,a,r,i){t.GetToken(function(s){t.options.token=s,t.Request(e,n,o,a,r,i)})},GetRankList:function(e,n,o){t.GetToken(function(){var a=e?0:1;t.Request("get",t.options.RankUrl,{Type:a},n,o)})},GetToken:function(e){var t="";try{t=new window.$TokenManagement("/TestApi/Api/wechat/GetToken","/TestApi/Api/wechat/GetTouristToken","/TestApi/Api/wechat/CheckToken","QIC").Get()}catch(e){t="",console.log("getToken error ",e)}if(t||(console.log("获取Token失败"),setTimeout(function(){window.vbus.$emit("ShowToast","登录失败,获取Token失败")},1e3)),"function"==typeof e)return void e(t)},GetBalance:function(e,n){t.APIRequest("get","getbalance",null,function(t){t.Success?e(t.Data):n(t)},n)},GetOddsByTime:function(e,n,o){t.APIRequest("get","getdatemenu",e,n,o)},GetOddsByLeague:function(e,n,o){t.APIRequest("get","getleaguemenu",e,n,o)},GetOddsByLive:function(e,n,o){e&&(e.isMix=!1),t.APIRequest("get","getweguessmatchodds",e,n,o)},GetOddsByMix:function(e,n,o){e&&(e.isMix=!0),t.APIRequest("get","getweguessmatchodds",e,n,o)},GetMatchOdd:function(e,n,o){t.APIRequest("get","getmatchdata",e,n,o)},GetBet:function(e,n,o){t.APIRequest("get","getbet",e,n,o)},GetMixBet:function(e,n,o){t.APIRequest("get","getmixbet",e,n,o)},Bet:function(e,n,o){t.APIRequest("post","bet",e,n,o)},BetMix:function(e,n,o){t.APIRequest("post","mixbet",e,n,o)},GetTimeLeague:function(e,n,o){t.APIRequest("get","getmatchlivedata",e,n,o)},GetResultLeague:function(e,n,o){t.APIRequest("get","getmatchresult",e,n,o)},GetProcessLeague:function(e,n,o){t.APIRequest("get","getmatchschedule",e,n,o)},GetUnbalancedBets:function(e,n){t.APIRequest("get","getunbalancedbetlist",{},e,n)},GetBalancedBetDate:function(e,n){t.APIRequest("get","getbalancedbetdate",{},e,n)},GetBalancedBets:function(e,n,o){t.APIRequest("get","getbalancedbetlist",{repDate:e},n,o)}};return t}),function(){var e={allowOddsStyle:2147483647,SN:{1:"soccer",2:"basketball",3:"football",4:"baseball",5:"hockey",6:"tennis",7:"volleyball",8:"handball",12:"volleyball"},MarketName:{1:"全场让球",2:"上半场让球",3:"全场大小",4:"上半场大小",5:"全场赛果",6:"上半场赛果",9:"全场波胆",10:"上半场波胆",11:"全场总进球数",12:"上半场总进球数"},MarketEnum:{F_HDP:1,H_HDP:2,F_OU:3,H_OU:4,F_1X2:5,H_1X2:6,F_OE:7,H_OE:8,F_CS:9,H_CS:10,F_TG:11,H_TG:12,F_FGLG:13,H_FGLG:14,FTHT:15,ML:16,Home_TG:17,Away_TG:18,WM:19,Home_CleanSheet:20,Away_CleanSheet:21,Home_WinNil:22,Away_WinNil:23,BothGoal:24,DC:25,TWH:26,Home_OU:27,Away_OU:28,HCS_FCS:29,OR:100,MIX:101},BetEnum:{Narmal:1,MixParlay:2,OutRight:3},BetListEnum:{Waiting:0,History:1},RequestBetError:{Success:0,OddChange:1,OutLeveChanged:2,TicketError:3,LimitError:4,SystemError:5,OverLimit:6,MixParamNotFind:7,NeedLogin:8},BetResultEnum:{Done:0,Fail:1,HdpChanged:2,OddsChanged:3,LessMinLimit:4,OverMaxlimit:5,OutLevelChanged:6,InsuffBalance:7,MixBetUnder:8,MixBetOver:9,QuotaLimit:10,NeedLogin:11,TooOften:12},BetStatusEnum:{All:-3,BetFail:-1,Waiting:0,Accepted:1,Settle:2,Cancel:3,Reject:4},MixMaxBet:10,MpIDs:[149,1,4,9,16,25,43,68,104],RefreshTime:{GuessTime:1e4,GuessLeague:1e4,GuessLive:5e3,GuessMix:1e4,Match:1e4,LeagueLive:1e4,LeagueResult:1e4,LeagueProcess:1e4},TestMode:!0};window.$config=e}(window),function(e,t){"function"==typeof t&&(e.HandleData=t(e))}(window,function(e){return{ComputeHDP:function(e){var t=Math.abs(e||0);return t=t%.5==.25?"{0}/{1}".format(t-.25,t+.25):t},showHDP:function(t,n,o){if(3==o||4==o)return e.HandleData.ComputeHDP(t);if(1==o||2==o){if(1==n)return e.HandleData.HdpH(t);if(2==n)return e.HandleData.HdpA(t)}return""},HdpH:function(t){var n=t<0?"-":"+";return(n=0==t?"":n)+e.HandleData.ComputeHDP(t)},HdpA:function(t){var n=t<0?"+":"-";return(n=0==t?"":n)+e.HandleData.ComputeHDP(t)},FormatOdds:function(e){return 0==e?"-":e},ComputeLiveTime:function(e,t,n){switch(e){case 1:switch(t){case-1:return"Live!";case 0:return"中场";case 1:return n<45?n+"'":"45'+";case 2:return 45+n+"'"}break;case 2:return t+"Q:"+n+"'"}return""},IsEmptyObj:function(e){if(null==e)return!0;for(var t in e)if(this.hasOwnProperty(t))return!0;return!1},CompareChange:function(t,n){if(null!=n){if(null==t)return t=null==n?{}:n,{};var o=t.MH,a=n,r={},i={};if(null!=o&&void 0!=o){for(var s=0;s<o.length;s++)i[o[s].MatchID+""]=s;if(a.D){var u={};a.D.forEach(function(e,t){u[e]=!0}),o.forEach(function(e,t){u.hasOwnProperty(e.MatchID)&&(o[t].MK={})}),u=null}if(a.MH){for(var c=0;c<a.MH.length;c++){var h=a.MH[c];if(c=i[a.MH[c].MatchID+""],o[c]&&null!=o[c]){if(h.ML&&h.ML.length>0&&(!o[c].ML||o[c].ML[2]==h.ML[2]&&o[c].ML[3]==h.ML[3]||(r["{0}-score".format(o[c].M[0])]=!0),o[c].ML=h.ML),h.M&&h.M.length>0&&(o[c].M=h.M),!h.MK||0==h.MK.length)return{};for(var f in h.MK)if(h.MK.hasOwnProperty(f)){var l=h.MK[f];o[c].MK[f]||(o[c].MK[f]=[]),l.forEach(function(e,t){e&&JSON.stringify(o[c].MK[f][t])!=JSON.stringify(e)&&(e.forEach(function(e,n){o[c].MK[f][t]&&o[c].MK[f][t][n]&&o[c].MK[f][t][n].toString()!=e&&(parseFloat(o[c].MK[f][t][n])<parseFloat(e)?r["{0}-{1}-{2}-{3}".format(o[c].M[0],f,t,n)]=1:parseFloat(o[c].MK[f][t][n])>parseFloat(e)&&(r["{0}-{1}-{2}-{3}".format(o[c].M[0],f,t,n)]=2))}),o[c].MK[f][t]=e)}),l.length<o[c].MK[f].length&&(o[c].MK[f]=o[c].MK[f].slice(0,l.length))}}else o.push(h)}t.MH=o}}else t.MH=a.MH;var d=e.Tools.ContactJson(t.LG,n.LG);return t.LG=d,r}},MatchChange:function(e,t){var n={};if(null==e)return e=null==t?{}:t,{};for(var o in t)"MK"!=o&&(e[o]=t[o]);if(null!=e.MK){for(var a in t.MK)if(t.MK.hasOwnProperty(a)){var r=t.MK[a];null!=r&&r.length>0?null!=e.MK[a]?r.forEach(function(t,o){e.MK[a].forEach(function(e,o){e[0]==t[0]&&t.forEach(function(t,r){parseFloat(t)>parseFloat(e[r])?n["{0}-{1}-{2}".format(a,o,r)]=1:parseFloat(t)<parseFloat(e[r])&&(n["{0}-{1}-{2}".format(a,o,r)]=2)})})}):e.MK[a]=r:e.MK[a]=null}}else e.MK=t.MK;return n}}}),function(e,t){"function"==typeof t&&(e.Language=t())}(window,function(){return{LoadingText:{LoadData:"加载数据",LoadGetBet:"获取投注",LoadBet:"正在下单"},DayList:["周天","周一","周二","周三","周四","周五","周六"]}}),function(e){e.setCookie=function(e,t,n){var o=30;"number"==typeof n&&n>0&&(o=n);var a=new Date;a.setTime(a.getTime()+24*o*60*60*1e3),document.cookie=e+"="+escape(t)+";expires="+a.toGMTString()},e.getCookie=function(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(n))?unescape(t[2]):null},e.delCookie=function(e){var t=new Date;t.setTime(t.getTime()-1);var n=getCookie(e);null!=n&&(document.cookie=e+"="+n+";expires="+t.toGMTString())}}(window),function(e){var t=function(){return this.SaveType=0,e.localStorage?(this.SaveType=1,!0):document.cookie||navigator.cookieEnabled?(this.SaveType=2,!0):!!e.sessionStorage&&(this.SaveType=3,!0)};t.prototype={Set:function(t,n){"object"==typeof n&&(n=JSON.stringify(n)),1===this.SaveType?e.localStorage[t]=n:2===this.SaveType?e.setCookie(t,n):3===this.SaveType&&e.sessionStorage.setItem(t,n)},Get:function(t,n,o){var a=n;1===this.SaveType?a=e.localStorage[t]||n:2===this.SaveType?a=e.getCookie(t,a)||n:3===this.SaveType&&(a=e.sessionStorage.getItem(t,a)||n);try{if(""==a)return a;o&&"string"==typeof a&&(a=JSON.parse(a))}catch(e){return a}return a},Delete:function(t){1===this.SaveType?e.localStorage[t]="":2===this.SaveType?e.delCookie(t,token):3===this.SaveType&&e.sessionStorage.setItem(t,"")}},e.$CacheMg=new t}(window),function(e){function t(e){e=e||{},e.method=e.method.toUpperCase()||"POST",e.url=e.url||"",e.async=void 0===e.async||e.async,e.data=e.data||null,e.success=e.success||function(){},e.header=e.header||{};var t=null;t=XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");var n=[];for(var o in e.data)n.push(o+"="+e.data[o]);var a=n.join("&");if("POST"===e.method.toUpperCase()){t.open(e.method,e.url,e.async),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),t.setRequestHeader("Access-Control-Allow-Origin","*");for(var r in e.header)e.header.hasOwnProperty(r)&&t.setRequestHeader(r,e.header[r]);t.send(a)}else if("GET"===e.method.toUpperCase()){t.open(e.method,e.url+"?"+a,e.async);for(var r in e.header)e.header.hasOwnProperty(r)&&t.setRequestHeader(r,e.header[r]);t.send(null)}if(t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){var n="";try{n=JSON.parse(t.responseText)}catch(e){n=t.responseText}e.success(n)}},!e.async){var i="";try{i=JSON.parse(t.responseText)}catch(e){i=t.responseText}return e.success(i),i}}var n=function(e,t,n){this.Tourist=1===Number($CacheMg.Get("Tourist","1")),this.IsLogin=!this.Tourist,this.RefreshTime=3e4,this.LastRefreshTime=Number($CacheMg.Get("LastRefreshTime","0")),this.GetTokenUrl=e,this.QIC=t||"QIC",this.$httpProvider=n,this.Token=$CacheMg.Get("Token",""),this.$httpProvider&&(this.$httpProvider.defaults.headers.common.Authorization=this.Token),this.Get()},o=null;n.prototype={Get:function(){var e=this,n=t({method:"Get",url:e.GetTokenUrl,data:{},async:!1,header:{Authorization:e.Token,QIC:e.QIC}});1===n.Result&&(e.LastRefreshTime=(new Date).getTime(),e.RefreshTime=n.Data.RefreshTime,e.Tourist=n.Data.Tourist,e.IsLogin=!n.Data.Tourist,e.Token=n.Data.Token,$CacheMg.Set("Token",e.Token),console.log("new Token "+e.Token),$CacheMg.Set("Tourist",e.Tourist?1:0),$CacheMg.Set("RefreshTime",e.RefreshTime),$CacheMg.Set("LastRefreshTime",e.LastRefreshTime),$httpProvider&&($httpProvider.defaults.headers.common.Authorization=n.Data.Token),o||(console.log("Refresh Token Start"),e.Refresh()))},Set:function(e,t,n){this.LastRefreshTime=e?(new Date).getTime():Number($CacheMg.Get("LastRefreshTime",(new Date).getTime()+"")),e&&""!=e&&($CacheMg.Set("LastRefreshTime",this.LastRefreshTime),$CacheMg.Set("Token",e)),this.Token=e||$CacheMg.Get("Token",""),t&&$CacheMg.Set("RefreshTime",t),this.RefreshTime=t||Number($CacheMg.Get("RefreshTime",3e4)),void 0!==n?($CacheMg.Set("Tourist",n?1:0),this.Tourist=n):this.Tourist=1===Number($CacheMg.Get("Tourist","1")),this.IsLogin=!this.Tourist,this.$httpProvider&&(this.$httpProvider.defaults.headers.common.Authorization=this.Token)},Refresh:function(){function e(){var e=(new Date).getTime();e-n.LastRefreshTime>n.RefreshTime&&(n.LastRefreshTime=e,t({method:"Get",url:n.RefreshUrl,data:{},header:{Authorization:n.Token,QIC:n.QIC},success:function(e){1===e.Result&&e.Data&&(n.LastRefreshTime=(new Date).getTime(),n.RefreshTime=e.Data.RefreshTime,n.Tourist=e.Data.Tourist,n.IsLogin=!e.Data.Tourist,n.Token=e.Data.Token,$CacheMg.Set("Token",n.Token),console.log("new Token "+n.Token),$CacheMg.Set("Tourist",n.Tourist?1:0),$CacheMg.Set("RefreshTime",n.RefreshTime),$CacheMg.Set("LastRefreshTime",n.LastRefreshTime),$httpProvider&&($httpProvider.defaults.headers.common.Authorization=e.Data.Token))}}))}if(!this.GetTokenUrl)return void console.log("RefreshUrl is null");var n=this;e(),o=setInterval(e,1e4)}},e.$TokenManagement=n}(window),function(e,t){"function"==typeof t&&(e.Tools=t(e))}(window,function(e){return{Fmoney:function(e){e=e>0&&e<=20?e:2;for(var t=parseFloat(this.replace(/[^\d\.-]/g,"")).toFixed(e)+"",n=t.split(".")[0].split("").reverse(),o=t.split(".")[1],a="",r=n.length,i=0;i<r;i++)a+=n[i]+((i+1)%3==0&&i+1!=r?",":"");return a.split("").reverse().join("")+"."+o},ContactJson:function(e,t){for(var n in t)e&&!e.hasOwnProperty(n)&&(e[n]=t[n]);return e},GetDateList:function(t,n){for(var o=new Array,a=0;a<n;a++){var r=new Date(t.getTime()+1e3*a*24*60*60),i={date:r.format("YY-MM-dd"),day:e.Language.DayList[r.getDay()]};o.push(i)}return o},ArrayContain:function(e,t,n){if(e instanceof Array)for(var o=0;o<e.length;o++)if(e[o][n]==t)return!0;return!1}}}),String.prototype.fmoney=function(e){e=e>0&&e<=20?e:2;for(var t=parseFloat(this.replace(/[^\d\.-]/g,"")).toFixed(e)+"",n=t.split(".")[0].split("").reverse(),o=(t.split(".")[1],""),a=n.length,r=0;r<a;r++)o+=n[r]+((r+1)%3==0&&r+1!=a?",":"");return o.split("").reverse().join("")},String.prototype.format=function(e){if(arguments.length>0){var t,n=this,o=arguments.length;if(1===o&&"object"==typeof e)for(var a in e)t=new RegExp("({"+a+"})","g"),n=n.replace(t,e[a]);else for(var r=0;r<o;r++)t=new RegExp("({["+r+"]})","g"),n=n.replace(t,arguments[r]);return n}return this},Date.prototype.format=function(e){var t={"Y+":this.getFullYear(),"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds(),P:this.getHours()<=12?"AM":"PM"};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(e)&&(e="Y+"==n?e.replace(RegExp.$1,t[n]):e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},Date.prototype.addHours=function(e){if(isNaN(e))return console.warn("parameter",e,"wrong,excepted for number."),this;var t=this.valueOf();return t+=parseInt(60*e*60*1e3),t=new Date(t)},Date.prototype.getReportDate=function(){var e=this.valueOf();return e+=parseInt(-432e5),e=new Date(e),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e},function(e){var t={},n="";setInterval(function(){n=""},5e3),e.KP={bind:function(e,n){e&&n&&(t[e.toLowerCase()]=n)}},e.document.onkeydown=function(e){var o=e.key.toLowerCase();n+=o;for(var a in t)if(t.hasOwnProperty(a)){var r=t[a];if(n.indexOf(a)>-1)try{n="",r(a)}catch(e){console.error(e)}else n.length>=500&&(n="")}}}(window),window.KP.bind("hh",function(e){document.location="/#/guess/time/1"}),window.KP.bind("jj",function(e){document.location="/#/leagues/result/1/2017-04-24"}),window.KP.bind("kk",function(e){document.location="/#/betlist"}),window.KP.bind("ll",function(e){document.location="/#/ranking"});